rvparasite
===========

A DLL file which is a parasite on RPG Tkool VX Ace Editor and hooks its actions.

RPG ツクール VX Ace のツクールエディターにロードさせ、その動作をフックし、対応するバッチスクリプトを実行するDLLです。

## 使い方

下記の作業を自動で行うバッチスクリプトが用意されています。
[installer/Readme.md](installer/Readme.md) を参照してください。

### 最初に行うこと

1. RPGツクールがインストールされているフォルダに`SciLexer`という*フォルダ*を作成する。
2. 1.で作成したフォルダに`SciLexer.dll`という*ファイル*を移動する。

#### 最初に行うこと - 全てのプロジェクトで使用する場合

1. rvparasiteに含まれる`scilexer.dll`をRPGツクールをインストールしたフォルダに移動する。

#### 最初に行うこと - 一部のプロジェクトで使用する場合

1. 「最初に行うこと」の1.で作成したフォルダにパスを通す。

パスを通すには次のような方法があります:

* 環境変数PATHに設定する。
* レジストリに `HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\App Paths\RPGVxAce.exe` というキーを作成し、`Path` という名前の文字列値にパスを書く。

注意：RPGツクールをインストールしたフォルダ*ではなく*、「最初に行うこと」の1.で作成した`SciLexer`というフォルダにパスを通してください。

### 新しいプロジェクトごとに行うこと

1. rvparasiteに含まれる`hooks`という*フォルダ*を、新しく作成したプロジェクトのフォルダに丸ごとコピーする。

#### 新しいプロジェクトごとに行うこと - 一部のプロジェクトで使用する場合

2. rvparasiteに含まれる`scilexer.dll`というファイルをプロジェクトのフォルダに置く。


## フックスクリプト

実行されるスクリプトのカレントディレクトリは、ツクールエディタで開いているプロジェクトの場所になります。

### 保存

* pre-save.bat - プロジェクトの保存が行われる前に呼び出されます。
* post-save.bat - プロジェクトの保存が行われた後に呼び出されます。

下記の場合に実行されます:

* メニューから「プロジェクトの保存」を選ぶ
* ツールバーのボタンから保存を行う
* Ctrl+Sで保存を行う

注意点:

* テストプレイ実行時に表示されるダイアログからの保存では実行されません。

### テスト実行

* pre-testplay.bat - テストプレイが行われる前に呼び出されます。

下記の場合に実行されます:

* メニューから「テストプレイ」を選ぶ
* ツールバーのボタンからテストプレイを行う
* F12でテストプレイを行う

注意点:

* 敵グループ編集画面の「戦闘テスト」からのテストプレイでは実行されません。
* テストプレイ実行前に表示される「保存」ダイアログより、先に実行されます。
* 実行後のフック処理は提供されていません。

rvhook では、「戦闘テスト」からの実行のフックや、ゲーム終了後のフックが可能です。併用も可能なので必要であれば rvhook を使用してください。


